Study on robust adaptive distances in ABC
=========================================

This is the code underlying the study "Robust adaptive distance functions
for approximate Bayesian inference on outlier-corrupted data" by
Yannik Sch√§lte, Emad Alamoudi, Jan Hasenauer, 2021.
Both analysis and figure generation code are included, facilitating
reproducibility with likely slight modifications.
The analysis uses Python 3.8, via a stand-alone miniconda installation.
Admin-rights are not required.

Installation
------------

The study is prepared for execution on Linux, particularly on the
Juelich Supercomputing Center (JSC) infrastructure.
To run on other systems, slight modifications to the
``install_all.sh`` and ``run_....sh`` scripts may be necessary.
The ``install_all.sh`` script handles the full installation process, including
a miniconda instance, Redis, pyABC, tumor2d, and this very repository.
It installs everything to a local conda environment `slad`, which can be
activated via `start_env.sh`.

Underlying code
---------------

* The ``slad`` module contains the test problems and some utility functions.
  It must be installed as mentioned above.

Study execution
---------------

* The study execution scripts are under ``scripts_...``.
* Particularly, these are ``run_all.py`` to run the first five model analyses,
  and ``run_tumor_noisy.py`` to run the tumor model analysis, under
  ``scripts_robust`` (using only the current acceptance criterion)
  and ``scripts_hist`` (using the current and previous acceptance criteria), for
  the main part of the study.
* These generate SQLite databases under ``data_...``. For each run, a separate
  database is created. If one exists already, the corresponding run is
  skipped.
* ``scripts_deviation`` contains an additional study on large outliers.
* The scripts expect to be run with a set-up Redis server. The whole process
  of server and worker setup and analysis script execution can be automatized
  via the ``run.sh`` command. An example call would be
  ``bash run.sh --port=9204 --nodes=2 --file=scripts_robust/run_all.py --time=24:00:00 --name=name1``.
* ``run.sh`` creates log files in ``out_...`` folders.
* Further, there are various scripts for detailed result inspection.
  These are not necessarily maintained.

Figure generation
-----------------

* The figure generation scripts are in ``figure_scripts_robust``.
* They require the data under ``data_...`` to exist.

Figures
-------

* The figures in the main manuscript and supplementary information are
  in the ``figures_...`` folders.
* Both ``.png`` and ``.pdf`` versions are provided.

Data
----

* The data are in folders ``data_...`` and generated by the corresponding
  ``scripts_...`` scripts.
* The data underlying the figures used in the manuscript are not contained
  in the online repository due to their size, however are available via
  a snapshot.
